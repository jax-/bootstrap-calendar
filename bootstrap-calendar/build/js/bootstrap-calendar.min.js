this.CalendarTemplates=this.CalendarTemplates||{},this.CalendarTemplates.alert=Handlebars.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i="function",j=this.escapeExpression;return h+='<div class="alert alert-',(g=c.alertType)?f=g.call(b,{hash:{},data:e}):(g=b&&b.alertType,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+' alert-dismissible" role="alert">\r\n    <button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>\r\n    ',(g=c.alertMessage)?f=g.call(b,{hash:{},data:e}):(g=b&&b.alertMessage,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+"\r\n</div>"}),this.CalendarTemplates.calendar=Handlebars.template(function(a,b,c,d,e){function f(a){var b="";return b+="\r\n            <th>\r\n                "+o(typeof a===n?a.apply(a):a)+"\r\n            </th>\r\n            "}function g(a,b){var d,e="";return e+='\r\n    <tr class="week">\r\n        ',d=c.each.call(a,a&&a.days,{hash:{},inverse:q.noop,fn:q.program(4,h,b),data:b}),(d||0===d)&&(e+=d),e+="\r\n    </tr>\r\n    "}function h(a,b){var d,e,f="";return f+='\r\n        <td class="',d=c["if"].call(a,a&&a.date_string,{hash:{},inverse:q.noop,fn:q.program(5,i,b),data:b}),(d||0===d)&&(f+=d),f+='" data-day="',(e=c.dayValue)?d=e.call(a,{hash:{},data:b}):(e=a&&a.dayValue,d=typeof e===n?e.call(a,{hash:{},data:b}):e),f+=o(d)+'">\r\n            <div class="week-day-div ',d=c["if"].call(a,a&&a.current,{hash:{},inverse:q.noop,fn:q.program(7,j,b),data:b}),(d||0===d)&&(f+=d),f+='">\r\n                <ul style="list-style:none;">\r\n                    <li><span class="date ">',(e=c.date_string)?d=e.call(a,{hash:{},data:b}):(e=a&&a.date_string,d=typeof e===n?e.call(a,{hash:{},data:b}):e),f+=o(d)+"</span></li>\r\n                    ",d=c.each.call(a,a&&a.events,{hash:{},inverse:q.noop,fn:q.programWithDepth(9,k,b,a),data:b}),(d||0===d)&&(f+=d),f+="\r\n                </ul>\r\n            </div>\r\n        </td>\r\n        "}function i(){return" week-day "}function j(){return" current "}function k(a,b,d){var e,f,g,h="";return h+='\r\n                    <li>\r\n                        <span class="event" data-day="'+o((e=d&&d.dayValue,typeof e===n?e.apply(a):e))+'" data-eventid="',(f=c.eventId)?e=f.call(a,{hash:{},data:b}):(f=a&&a.eventId,e=typeof f===n?f.call(a,{hash:{},data:b}):f),h+=o(e)+'" style="background-color:'+o((e=a&&a.color,typeof e===n?e.apply(a):e))+'">\r\n                            <span>'+o((e=a&&a.personName,typeof e===n?e.apply(a):e))+" - "+o((f=c.formatEventName||a&&a.formatEventName,g={hash:{},data:b},f?f.call(a,a&&a.eventName,g):p.call(a,"formatEventName",a&&a.eventName,g)))+"</span>\r\n                        </span>\r\n                    </li>\r\n                    "}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var l,m="",n="function",o=this.escapeExpression,p=c.helperMissing,q=this;return m+='\r\n<table class="table calendar">\r\n    <thead>\r\n        <tr>\r\n            ',l=c.each.call(b,b&&b.weekdays,{hash:{},inverse:q.noop,fn:q.program(1,f,e),data:e}),(l||0===l)&&(m+=l),m+="\r\n        </tr>\r\n    </thead>\r\n    ",l=c.each.call(b,b&&b.weeks,{hash:{},inverse:q.noop,fn:q.program(3,g,e),data:e}),(l||0===l)&&(m+=l),m+="\r\n\r\n</table>"}),this.CalendarTemplates.calendarContainer=Handlebars.template(function(a,b,c,d,e){return this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{},'\r\n<div class="calendar-alertarea"></div>\r\n<div class="calendar-nav-panel">\r\n\r\n</div>\r\n<div class="calendar-container"></div>\r\n<div class="event-container"></div>\r\n\r\n<div class="calendar-loader"></div> '}),this.CalendarTemplates.eventModal=Handlebars.template(function(a,b,c,d,e){function f(){return"\r\n                            <span>Select person:</span>\r\n                        "}function g(a){var b,c="";return c+="\r\n                            <span>"+m((b=a&&a.RESOURCES,b=null==b||b===!1?b:b.PERSON_NAME,typeof b===l?b.apply(a):b))+"</span>\r\n                        "}function h(a,b){var e,f="";return f+="\r\n                            ",e=n.invokePartial(d.selectPartial,"selectPartial",a,c,d,b),(e||0===e)&&(f+=e),f+="\r\n                        "}function i(){return'\r\n                            <input class="person form-control">\r\n                        '}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),d=this.merge(d,a.partials),e=e||{};var j,k="",l="function",m=this.escapeExpression,n=this;return k+='<div id="calendarEventModal" class="modal fade">\r\n    <div class="modal-dialog">\r\n        <div class="modal-content">\r\n            <div class="modal-header">\r\n                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">'+m((j=b&&b.RESOURCES,j=null==j||j===!1?j:j.CLOSE,typeof j===l?j.apply(b):j))+'</span></button>\r\n                <h4 class="modal-title">'+m((j=b&&b.RESOURCES,j=null==j||j===!1?j:j.MODAL_TITLE,typeof j===l?j.apply(b):j))+' <span class="modalTitleDate"></span></h4>\r\n            </div>\r\n            <div class="modal-body">\r\n                <p>'+m((j=b&&b.RESOURCES,j=null==j||j===!1?j:j.MODAL_BODY,typeof j===l?j.apply(b):j))+'</p>\r\n\r\n                <div class="row row-mar">\r\n                    <div class="col-md-5 col-lg-5">\r\n                        ',j=c["if"].call(b,b&&b.enable_dropdown,{hash:{},inverse:n.program(3,g,e),fn:n.program(1,f,e),data:e}),(j||0===j)&&(k+=j),k+='\r\n                    </div>\r\n                    <div class="col-md-7 col-lg-7">\r\n                        ',j=c["if"].call(b,b&&b.enable_dropdown,{hash:{},inverse:n.program(7,i,e),fn:n.program(5,h,e),data:e}),(j||0===j)&&(k+=j),k+='\r\n                    </div>\r\n                </div>\r\n\r\n                <div class="row row-mar">\r\n                    <div class="col-md-5 col-lg-5">\r\n                        <span>'+m((j=b&&b.RESOURCES,j=null==j||j===!1?j:j.EVENT_NAME,typeof j===l?j.apply(b):j))+':</span>\r\n                    </div>\r\n                    <div class="col-md-7 col-lg-7">\r\n                        <textarea maxlength="500" rows="4" class="eventName form-control" />\r\n                    </div>\r\n                </div>\r\n\r\n                <div class="row row-mar">\r\n                    <div class="col-md-5 col-lg-5">\r\n                        Time from:\r\n                    </div>\r\n                    <div class="col-md-7 col-lg-7">\r\n                        <input class="timeFrom form-control" />\r\n                    </div>\r\n                </div>\r\n\r\n                <div class="row row-mar">\r\n                    <div class="col-md-5 col-lg-5">\r\n                        Time to:\r\n                    </div>\r\n\r\n                    <div class="col-md-7 col-lg-7">\r\n                        <input class="timeTo form-control" />\r\n                    </div>\r\n                </div>\r\n\r\n                <input type="hidden" class="eventId" />\r\n                <input type="hidden" class="eventDay" />\r\n\r\n                <div style="clear:both"></div>\r\n            </div>\r\n            <div class="modal-footer">\r\n                <button type="button" class="btn btn-primary add-event">'+m((j=b&&b.RESOURCES,j=null==j||j===!1?j:j.ADD,typeof j===l?j.apply(b):j))+'</button>\r\n                <button type="button" class="btn btn-primary edit-event">'+m((j=b&&b.RESOURCES,j=null==j||j===!1?j:j.EDIT,typeof j===l?j.apply(b):j))+'</button>\r\n                <button type="button" class="btn btn-default" data-dismiss="modal">'+m((j=b&&b.RESOURCES,j=null==j||j===!1?j:j.CLOSE,typeof j===l?j.apply(b):j))+"</button>\r\n            </div>\r\n        </div><!-- /.modal-content -->\r\n    </div><!-- /.modal-dialog -->\r\n</div><!-- /.modal -->"}),this.CalendarTemplates.events=Handlebars.template(function(a,b,c,d,e){function f(a,b){var d,e,f,h="";return h+='\r\n            <tr class="',d=c["if"].call(a,a&&a.unsaved,{hash:{},inverse:j.noop,fn:j.program(2,g,b),data:b}),(d||0===d)&&(h+=d),h+='" >\r\n                <td>\r\n                    '+l((d=a&&a.eventId,typeof d===k?d.apply(a):d))+"\r\n                </td>\r\n                <td>\r\n                    "+l((e=c.formatDate||a&&a.formatDate,f={hash:{},data:b},e?e.call(a,a&&a.year,a&&a.month,a&&a.day,f):m.call(a,"formatDate",a&&a.year,a&&a.month,a&&a.day,f)))+"\r\n                </td>\r\n                <td>\r\n                    "+l((d=a&&a.timeFrom,typeof d===k?d.apply(a):d))+" - "+l((d=a&&a.timeTo,typeof d===k?d.apply(a):d))+"\r\n                </td>\r\n                <td>\r\n                    "+l((d=a&&a.personName,typeof d===k?d.apply(a):d))+"\r\n                </td>\r\n                <td>\r\n                    "+l((d=a&&a.eventName,typeof d===k?d.apply(a):d))+'\r\n                </td>\r\n               <td>\r\n                   <a href="#" class="edit-event2" data-eventid="'+l((d=a&&a.eventId,typeof d===k?d.apply(a):d))+'">Edit</a>\r\n               </td>\r\n              <td>\r\n                  <a href="#" class="remove-event2" data-eventid="'+l((d=a&&a.eventId,typeof d===k?d.apply(a):d))+'">Remove</a>\r\n              </td>\r\n            </tr>\r\n            '}function g(){return"warning"}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var h,i="",j=this,k="function",l=this.escapeExpression,m=c.helperMissing;return i+='<div class="event-list ">\r\n  <hr />\r\n    <h3>Event list</h3>\r\n    <table class="table  table-hover table-striped table-responsive">\r\n        <thead>\r\n            <tr>\r\n                <th>\r\n                    Id\r\n                </th>\r\n                <th>\r\n                    Date\r\n                </th>\r\n                <th>\r\n                    Time\r\n                </th>\r\n                <th>\r\n                    Person name\r\n                </th>\r\n                <th>\r\n                    Event name\r\n                </th>\r\n                <th></th>\r\n                <th></th>\r\n            </tr>\r\n        </thead>\r\n        <tbody>\r\n            ',h=c.each.call(b,b,{hash:{},inverse:j.noop,fn:j.program(1,f,e),data:e}),(h||0===h)&&(i+=h),i+="\r\n        </tbody>\r\n    </table>\r\n</div>"}),this.CalendarTemplates.navpanel=Handlebars.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i="function",j=this.escapeExpression;return h+='<div class="calendar-panel calendar-nav-panel text-right">\r\n    <button class="btn btn-nav btn-default prev-year btn-lg"><<</button>\r\n    <button class="btn btn-nav btn-default prev-month btn-lg"><</button>\r\n\r\n    <h2 style="display:inline-block; padding: 0 0; margin: 0 0;">\r\n        <span class="label label-primary label-lg currentYearMonth">',(g=c.currentYearMonth)?f=g.call(b,{hash:{},data:e}):(g=b&&b.currentYearMonth,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'</span>\r\n    </h2>\r\n\r\n    <button class="btn btn-nav btn-default next-month btn-lg">></button>\r\n    <button class="btn btn-nav btn-default next-year btn-lg">>></button>\r\n</div>\r\n'}),this.CalendarTemplates.panel=Handlebars.template(function(a,b,c,d,e){return this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{},'<div class="calendar-panel text-center">\r\n\r\n    <!--<button class="btn btn-primary load-people">Load people</button>-->\r\n\r\n    <div class="pull-right">\r\n        <button class="btn btn-default panel-add-event" style="display:none">Add event</button>\r\n        <button class="btn btn-default panel-edit-event" style="display:none">Edit event</button>\r\n        <button class="btn btn-default panel-remove-event" style="display:none">Remove event</button>\r\n\r\n\r\n        <button class="btn btn-default save-events" style="margin-right:10px;">Save events</button>\r\n        <label for="event-autosave">Autosave</label>\r\n        <input type="checkbox" id="event-autosave" class="event-autosave" />\r\n    </div>\r\n    <div style="clear:both">\r\n\r\n</div>  '}),this.CalendarTemplates.selectPartial=Handlebars.template(function(a,b,c,d,e){function f(a,b){var d,e,f="";return f+='\r\n        <option value="',(e=c.personId)?d=e.call(a,{hash:{},data:b}):(e=a&&a.personId,d=typeof e===i?e.call(a,{hash:{},data:b}):e),f+=j(d)+'">',(e=c.personName)?d=e.call(a,{hash:{},data:b}):(e=a&&a.personName,d=typeof e===i?e.call(a,{hash:{},data:b}):e),f+=j(d)+"</option>\r\n    "}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var g,h="",i="function",j=this.escapeExpression,k=this;return h+='<select class="person form-control">\r\n    ',g=c.each.call(b,b&&b.people,{hash:{},inverse:k.noop,fn:k.program(1,f,e),data:e}),(g||0===g)&&(h+=g),h+="\r\n</select>"}),function(a){var b=function(b){Array.prototype.insert=function(a,b){this.splice(a,0,b)};var c={MODAL_TITLE:"Event modal",MODAL_BODY:"Please insert attendee and event names",PERSON_NAME:"Attendee's name",EVENT_NAME:"Event's name",ADD_EVENT_TITLE:"Add event",EDIT_EVENT_TITLE:"Edit event",CLOSE:"Close",ADD:"Add",EDIT:"Edit",PREVIOUS_YEAR:"Previous year",NEXT_YEAR:"Next year",PREVIOUS_MONTH:"Previous month",NEXT_MONTH:"Next month",AUTOSAVE:"Autosave",SAVE_EVENTS:"Save events",CLEAR_EVENTS:"Clear events",REMOVE:"Remove"},d=null,e=!1,f="localStorage",g=void 0,h=null,i=null,j=!0,k=void 0,l="top",m="",n=!0,o=!0,p=function(){return void 0!=localStorage?(this.saveAllEvents=function(){if(v instanceof Object){for(var a=[],b=0;b<v.length;b++){var c=v[b],d={};jQuery.extend(d,c),d.container=void 0,a.push(d)}var e=JSON.stringify(a);localStorage.setItem("events",e)}else localStorage.removeItem("events")},this.readAllEvents=function(){var a=localStorage.getItem("events");try{if(void 0==a||void 0==a)throw new Error("temp is undefined");for(var b=JSON.parse(a),c=0;c<b.length;c++){var d=b[c];M(d,!1)}}catch(e){v=new r}},this.clearAllEvents=function(){v=new r,localStorage.removeItem("events")},this):void 0},q=function(){var a="ready";$(".calendar-loader").hide();var b=function(b){switch(a=b,b){case"load":$(".calendar-loader").fadeIn(250);break;case"idle":case"ready":$(".calendar-loader").fadeOut(500)}};this.urls={getAllEvents:""},this.setUrls=function(a){this.urls=a},this.getUrls=function(){return this.urls};var c=function(a){for(var b=0;b<a.length;b++){var c=a[b];c.unsaved=!1}};return this.saveData=function(){var a={eventsToAdd:s,eventsToRemove:t,eventsToEdit:u},d=JSON.stringify(a);b("load"),$.ajax({type:"POST",url:this.urls.saveData,contentType:"application/json",data:d,success:function(){console.log("saved"),Z("Events have been saved","success"),c(u),c(s),db(!1),Y()},error:function(a){Z("There was an error while trying to save events","danger"),console.log(a)},complete:function(){b("idle")}})},this.saveAllEvents=function(){this.saveData()},this.readAllPeople=function(a){void 0==a&&(a=!1),void 0!=this.urls.getPeople&&(b("load"),$.ajax({type:"GET",url:this.urls.getPeople,success:function(a){var b=$("#calendarEventModal .person"),c={people:a},d=k.selectPartial(c);b.replaceWith(d)},complete:function(){b("idle")}}))},this.readAllEvents=function(a,c){void 0==a&&(a=!1),b("load"),$.ajax({type:"GET",url:this.urls.getEvents,success:function(b){if(void 0!=b&&null!=b)for(var d=0;d<b.length;d++){var e=b[d];e.month-=1,M(e,!1)}a&&void 0!=c&&c(),W()},error:function(a){console.log(a)},complete:function(){b("idle")}})},this.clearAllEvents=function(){console.log("This function is not supported")},this},r=function(){return new Array},s=[],t=[],u=[],v=[],w=[],x=function(a,b,c){var d=b+1;return 10>d&&(d="0"+d),void 0!=c?(10>c&&(c="0"+c),a+"-"+d+"-"+c):void 0!=a&&void 0!=b?a+" - "+d:""},y=function(a,b){return R(b,!0)+" "+a},z=function(a){return a.length>20?a.substring(0,18)+"...":a},A=function(){k=CalendarTemplates,Handlebars.registerPartial("selectPartial",k.selectPartial),Handlebars.registerHelper("formatDate",x),Handlebars.registerHelper("formatEventName",z)},B=function(){A();var c=b,k="Calendar cannot be initialized. Dependency required: ";if(void 0==a.Handlebars)throw new Error(k+"Handlebars.js");if(void 0==a.jQuery)throw new Error(k+"jQuery.js");var m=!1;if("string"==typeof c)d=c;else{if("object"!=typeof c)throw new Error("Invalid options");if(d=c.selector,void 0!=c.debug&&(e=c.debug),void 0!=c.sync){var o={};if("string"==typeof c.sync?f=c.sync:"object"==typeof c.sync&&(void 0!=c.sync.type&&(f=c.sync.type),o.getEvents=c.sync.getEvents,o.saveData=c.sync.saveData,o.getPeople=c.sync.getPeople),"localStorage"!=f&&"remote"!=f)throw new Error("Invalid sync type");switch(f){case"localStorage":g=new p;break;case"remote":g=new q,g.setUrls(o),g.readAllPeople(),m=!0;break;default:g=void 0}void 0!=g.readAllEvents&&g.readAllEvents(m)}void 0!=c.showEventList&&(1==c.showEventList||0==c.showEventList)&&(n=c.showEventList)}if(void 0==d||null==d)throw new Error("Invalid selector");if(e)for(var r=0;12>r;r++)for(var s=1;31>=s;s++)for(var t=0;1>t;t++)L(2014,r,s,1,"Jan Kowalski","Swimming",void 0,r*s*t);if(void 0==c.year||void 0==c.month&&"number"!=typeof c.year||"number"!=typeof c.month){var u=new Date;h=u.getFullYear(),i=u.getMonth()}else V(c.year,c.month);void 0==c.panel||"bottom"!=c.panel&&"top"!=c.panel||(l=c.panel),C(),D(),E(l),I(),K(),void 0!=c.render&&(j=c.render),j&&W()},C=function(){var a=k.calendarContainer();$(d).append(a),m=".calendar-container"},D=function(){var a={add:!0,RESOURCES:c,enable_dropdown:!0,people:w},b=k.eventModal(a);$("body").append(b)},E=function(a){var b=h+" - "+(i+1),c={currentYearMonth:b},e=k.panel(c);"bottom"==a?$(m).after(e):$(m).before(e);var f=k.navpanel();$(d+" .calendar-nav-panel").replaceWith(f)},F=function(){var a=$(".calendar-panel .event-autosave");return void 0!=a&&a.length>0?a[0].checked:!1},G=function(a,b){var c=bb(b.year,b.month,b.day);a.find(".modalTitleDate").html(c),a.find(".eventDay").val(b.day),a.find(".eventId").val(b.eventId),a.find(".person").val(b.personId),a.find(".timeFrom").val(b.timeFrom),a.find(".timeTo").val(b.timeTo);var d=a.find(".eventName");d.attr("value",b.eventName)},H=function(a,b){var c=a.find(".add-event"),d=a.find(".edit-event");c.hide(),d.hide(),"edit"==b?d.show():c.show()},I=function(){var a=".calendar-panel ";$(a+".prev-month").click(function(){i--,0>i&&(i=11,h--),W()}),$(a+".next-month").click(function(){i++,i>11&&(i=0,h++),W()});var b=function(a){h+=a,W()};$(a+".prev-year").click(function(){b(-1)}),$(a+".next-year").click(function(){b(1)});var c="#calendarEventModal",e=function(a){var b=$(c),d=b.find(".person"),e=b.find(".eventName"),f=d.val(),g=b.find(".person option:selected").text(),j=b.find(".timeFrom"),k=b.find(".timeTo"),l=e.val();return void 0!=l&&""!=l?(L(h,i,a,f,g,l,void 0,j.val(),k.val()),W(),d.val(""),e.val(""),!0):!1},f=function(a,b){return b.eventId=a.find(".eventId").val(),b.personId=a.find(".person").val(),b.personName=a.find(".person option:selected").text(),b.timeFrom=a.find(".timeFrom").val(),b.timeTo=a.find(".timeTo").val(),b.eventName=a.find(".eventName").val(),b.unsaved=!0,u.push(b),F()&&cb(),!0};$(d).on("click",".panel-add-event",function(){var a=$(c),b=$(d).find(".week-day-div.selected");if(b.length>0){var e=$(b).parent().data("day"),f=h+"-"+i+"-"+e,g=a.find(".modalTitleDate");g.html(f);var j=a.find(".eventDay");j.val(e),H(a,"add"),a.modal("show")}}),$(d).on("click",".panel-edit-event",function(){var a=$(c),b=$(d).find(".event.selected");if(b.length>0){var e=($(b).data("day"),$(b).data("eventid")),f=N(e);null!=f&&(G(a,f),H(a,"edit"),a.modal("show"))}}),$(d).on("click",".panel-remove-event",function(){var a=$(d).find(".event.selected");if(a.length>0){var b=($(a).data("day"),$(a).data("eventid"));void 0!=b&&(O(b),W())}}),$(d).on("click",".week-day-div",function(){var a=$(this).hasClass("selected");a?J("none"):(J("add"),$(this).addClass("selected"))}),$(d).on("click",".event",function(a){a.stopPropagation();var b=$(this).hasClass("selected");b?J("none"):(J("edit"),$(this).addClass("selected"))}),$(c+" .add-event").click(function(){var a=$(c+" .eventDay").val(),b=e(a);if(b){var d=$(c);d.modal("hide"),J("none")}}),$(c+" .edit-event").click(function(){var a=$(c),b=a.find(".eventId").val(),d=N(b);if(null!=d){var e=f(a,d);e&&(a.modal("hide"),J("none"),W())}}),$(a+".save-events").click(function(){cb()}),$(a+".clear-events").click(function(){db(!0),W()}),$(a+".reload-events").click(function(){db(!0),g.readAll(!0,function(){W()})}),$(a+".load-people").click(function(){void 0!=g.readAllPeople&&g.readAllPeople(!0)})},J=function(a){var b=$(d+" .btn.panel-add-event"),c=$(d+" .btn.panel-edit-event"),e=$(d+" .btn.panel-remove-event");b.hide(),c.hide(),e.hide(),$(d+" .event").removeClass("selected"),$(d+" .week-day-div").removeClass("selected"),"add"==a?b.show():"edit"==a&&(c.show(),e.show())},K=function(){$(".event-container").on("click",".edit-event2",function(){var a=$(this).data("eventid"),b=N(a),c=$("#calendarEventModal");return null!=b&&(G(c,b),H(c,"edit"),c.modal("show")),!1}),$(".event-container").on("click",".remove-event2",function(){var a=$(this).data("eventid");return void 0!=a&&(O(a),W()),!1})},L=function(a,b,c,d,e,f,g,h,i,j){void 0==g&&(g=ab()),void 0==j&&(j="t_"+(new Date).getTime());var k={eventId:j,personId:d,personName:e,eventName:f,color:g,unsaved:!0,year:a,month:b,day:c,timeFrom:h,timeTo:i};M(k,!0),F()&&cb()},M=function(a,b){void 0==b&&(b=!1),"object"==typeof a&&(b&&(a.unsaved=!0,s.push(a)),v.push(a))},N=function(a){for(var b=0;b<v.length;b++){var c=v[b];if(c.eventId==a)return c}return null},O=function(a){for(var b=null,c=0;c<v.length;c++)if(v[c].eventId==a){b=v[c];break}if(null!=b){var d=v.indexOf(b);-1!=d&&(t.push(b),v.splice(d,1))}F()&&cb()},P=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],Q={1:"January",2:"February",3:"March",4:"April",5:"May",6:"June",7:"July",8:"August",9:"September",10:"October",11:"November",12:"December"},R=function(a,b){b&&a++;var c=String(a);return Q[c]},S=function(a,b,c){for(var d=[],e=0;e<v.length;e++){var f=v[e];f.year==a&&f.month==b&&f.day==c&&d.push(f)}return d},T=function(a,b){for(var c=[],d=0;d<v.length;d++){var e=v[d];e.year==a&&e.month==b&&c.push(e)}return c},U=function(a,b){var c=new Date,d=c.getFullYear(),e=c.getMonth(),f=c.getDate(),g=new Date(a,b),h=(g.getMonth(),[]),i={days:[]},j=0,k=function(a){j++,i.days.push(a)},l=function(){h.push(i),i={days:[]}},m=new Date(g);m.setDate(m.getDate()-1);for(var n=m.getDay(),o=0;n>o;o++)k({});var p=g.getDate();do{j%7==0&&l(i);var q={date_string:bb(a,b,p),bg_color:"#DEDEDE",dayValue:p};a==d&&b==e&&p==f&&(q.current=!0);var r=S(a,b,p);q.events=r,k(q),p++,g=new Date(a,b,p),p=g.getDate()}while(p>1);return i.days.length>0&&l(i),h},V=function(a,b){h=a,i=b},W=function(a,b,c){void 0!=a&&void 0!=b&&V(a,b),void 0==c&&(c=["calendar","events"]),X(),Y();var d=y(h,i);$(".calendar-panel .currentYearMonth").html(d),-1!=c.indexOf("calendar"),c.indexOf("events")-1},X=function(){var a=$(m),b=h;b+=9>i?" 0"+(i+1):" "+(i+1);var c=U(h,i),d={weekdays:P,weeks:c},e=k.calendar(d);a.html(e)},Y=function(){if(n){var a=null;a=o?T(h,i):v;var b=k.events(a);$(d+" .event-container").html(a.length>0?b:"")}},Z=function(a,b){void 0==b&&(b="success");var c={alertType:b,alertMessage:a},e=k.alert(c);$(d+" .calendar-alertarea").html(e)},_=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"],ab=function(){for(var a="#",b=0;6>b;b++){var c=Math.round(Math.random()*(_.length-1));a+=_[c]}return a},bb=function(a,b,c){return b+=1,10>b&&(b="0"+b),10>c&&(c="0"+c),a+"-"+b+"-"+c},cb=function(){void 0!=g&&g.saveAllEvents()},db=function(a){void 0==a&&(a=!0),a&&(v=new r),s=new r,t=new r,u=new r},eb=function(a){if(7!=a.length)throw new Error("Array should have 7 elements");P=a},fb=function(a){if(12!=Object.keys(a).length)throw new Error("Object should have 12 elements");Q=a};return B(),{render:W,addEvent:L,removeEvent:O,getEvents:function(){return v},saveEvents:cb,clearEvents:db,loadWeekStrings:eb,loadMonthStrings:fb}};a.Calendar=b}(window);