this.CalendarTemplates=this.CalendarTemplates||{},this.CalendarTemplates["src/templates/calendar"]=Handlebars.template(function(a,b,c,d,e){function f(a){var b="";return b+="\r\n            <th>\r\n                "+o(typeof a===n?a.apply(a):a)+"\r\n            </th>\r\n            "}function g(a,b){var d,e="";return e+='\r\n    <tr class="week">\r\n        ',d=c.each.call(a,a&&a.days,{hash:{},inverse:p.noop,fn:p.program(4,h,b),data:b}),(d||0===d)&&(e+=d),e+="\r\n    </tr>\r\n    "}function h(a,b){var d,e,f="";return f+='\r\n        <td class="',d=c["if"].call(a,a&&a.date_string,{hash:{},inverse:p.noop,fn:p.program(5,i,b),data:b}),(d||0===d)&&(f+=d),f+='" data-day="',(e=c.dayValue)?d=e.call(a,{hash:{},data:b}):(e=a&&a.dayValue,d=typeof e===n?e.call(a,{hash:{},data:b}):e),f+=o(d)+'">\r\n            <div class="week-day-div ',d=c["if"].call(a,a&&a.current,{hash:{},inverse:p.noop,fn:p.program(7,j,b),data:b}),(d||0===d)&&(f+=d),f+='">\r\n                <ul style="list-style:none;">\r\n                    <li><span class="date ">',(e=c.date_string)?d=e.call(a,{hash:{},data:b}):(e=a&&a.date_string,d=typeof e===n?e.call(a,{hash:{},data:b}):e),f+=o(d)+"</span></li>\r\n                    ",d=c.each.call(a,a&&a.events,{hash:{},inverse:p.noop,fn:p.programWithDepth(9,k,b,a),data:b}),(d||0===d)&&(f+=d),f+="\r\n                </ul>\r\n            </div>\r\n        </td>\r\n        "}function i(){return" week-day "}function j(){return" current "}function k(a,b,d){var e,f,g="";return g+='\r\n                    <li>\r\n                        <span class="event" data-day="'+o((e=d&&d.dayValue,typeof e===n?e.apply(a):e))+'" data-eventid="',(f=c.eventId)?e=f.call(a,{hash:{},data:b}):(f=a&&a.eventId,e=typeof f===n?f.call(a,{hash:{},data:b}):f),g+=o(e)+'" style="background-color:'+o((e=a&&a.color,typeof e===n?e.apply(a):e))+'">\r\n                            <span>'+o((e=a&&a.personName,typeof e===n?e.apply(a):e))+" - "+o((e=a&&a.eventName,typeof e===n?e.apply(a):e))+"</span>\r\n                        </span>\r\n                    </li>\r\n                    "}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var l,m="",n="function",o=this.escapeExpression,p=this;return m+='\r\n<table class="table calendar">\r\n    <thead>\r\n        <tr>\r\n            ',l=c.each.call(b,b&&b.weekdays,{hash:{},inverse:p.noop,fn:p.program(1,f,e),data:e}),(l||0===l)&&(m+=l),m+="\r\n        </tr>\r\n    </thead>\r\n    ",l=c.each.call(b,b&&b.weeks,{hash:{},inverse:p.noop,fn:p.program(3,g,e),data:e}),(l||0===l)&&(m+=l),m+="\r\n\r\n</table>"}),this.CalendarTemplates["src/templates/eventModal"]=Handlebars.template(function(a,b,c,d,e){function f(a,b){var e,f="";return f+="\r\n                    <span>Select person:</span>\r\n                    ",e=j.invokePartial(d.selectPartial,"selectPartial",a,c,d,b),(e||0===e)&&(f+=e),f+="\r\n                "}function g(a){var b,c="";return c+="\r\n                <span>"+l((b=a&&a.RESOURCES,b=null==b||b===!1?b:b.PERSON_NAME,typeof b===k?b.apply(a):b))+':</span>\r\n                <input class="person" />\r\n                '}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),d=this.merge(d,a.partials),e=e||{};var h,i="",j=this,k="function",l=this.escapeExpression;return i+='<div id="calendarEventModal" class="modal fade">\r\n    <div class="modal-dialog">\r\n        <div class="modal-content">\r\n            <div class="modal-header">\r\n                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">'+l((h=b&&b.RESOURCES,h=null==h||h===!1?h:h.CLOSE,typeof h===k?h.apply(b):h))+'</span></button>\r\n                <h4 class="modal-title">'+l((h=b&&b.RESOURCES,h=null==h||h===!1?h:h.MODAL_TITLE,typeof h===k?h.apply(b):h))+' <span class="modalTitleDate"></span></h4>\r\n            </div>\r\n            <div class="modal-body">\r\n                <p>'+l((h=b&&b.RESOURCES,h=null==h||h===!1?h:h.MODAL_BODY,typeof h===k?h.apply(b):h))+"</p>\r\n\r\n                ",h=c["if"].call(b,b&&b.enable_dropdown,{hash:{},inverse:j.program(3,g,e),fn:j.program(1,f,e),data:e}),(h||0===h)&&(i+=h),i+="\r\n\r\n                <br />\r\n                <span>"+l((h=b&&b.RESOURCES,h=null==h||h===!1?h:h.EVENT_NAME,typeof h===k?h.apply(b):h))+':</span>\r\n                <input class="eventName" />\r\n\r\n                <br/>\r\n                Time from:\r\n                <input class="timeFrom" />\r\n\r\n                Time to:\r\n                <input class="timeTo" />\r\n\r\n                <input type="hidden" class="eventId" />\r\n                <input type="hidden" class="eventDay" />\r\n            </div>\r\n            <div class="modal-footer">\r\n                <button type="button" class="btn btn-primary add-event">'+l((h=b&&b.RESOURCES,h=null==h||h===!1?h:h.ADD,typeof h===k?h.apply(b):h))+'</button>\r\n                <button type="button" class="btn btn-primary edit-event">'+l((h=b&&b.RESOURCES,h=null==h||h===!1?h:h.EDIT,typeof h===k?h.apply(b):h))+'</button>\r\n                <button type="button" class="btn btn-default" data-dismiss="modal">'+l((h=b&&b.RESOURCES,h=null==h||h===!1?h:h.CLOSE,typeof h===k?h.apply(b):h))+"</button>\r\n            </div>\r\n        </div><!-- /.modal-content -->\r\n    </div><!-- /.modal-dialog -->\r\n</div><!-- /.modal -->"}),this.CalendarTemplates["src/templates/events"]=Handlebars.template(function(a,b,c,d,e){function f(a){var b,c="";return c+="\r\n            <tr>\r\n                <td>\r\n                    "+j((b=a&&a.eventId,typeof b===i?b.apply(a):b))+"\r\n                </td>\r\n                <td>\r\n                    "+j((b=a&&a.year,typeof b===i?b.apply(a):b))+"-"+j((b=a&&a.month,typeof b===i?b.apply(a):b))+"-"+j((b=a&&a.day,typeof b===i?b.apply(a):b))+"\r\n                </td>\r\n                <td>\r\n                    "+j((b=a&&a.person,typeof b===i?b.apply(a):b))+"\r\n                </td>\r\n                <td>\r\n                    "+j((b=a&&a.eventName,typeof b===i?b.apply(a):b))+'\r\n                </td>\r\n               <td>\r\n                   <a href="#" class="edit-event2" data-eventid="'+j((b=a&&a.eventId,typeof b===i?b.apply(a):b))+'">Edit</a>\r\n               </td>\r\n              <td>\r\n                  <a href="#" class="remove-event2" data-eventid="'+j((b=a&&a.eventId,typeof b===i?b.apply(a):b))+'">Remove</a>\r\n              </td>\r\n            </tr>\r\n            '}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var g,h="",i="function",j=this.escapeExpression,k=this;return h+='<div class="event-list ">\r\n  <hr />\r\n    <h3>Event list</h3>\r\n    <table class="table  table-hover table-striped table-responsive">\r\n        <thead>\r\n            <tr>\r\n                <th>\r\n                    Id\r\n                </th>\r\n                <th>\r\n                    Date\r\n                </th>\r\n                <th>\r\n                    Person name\r\n                </th>\r\n                <th>\r\n                    Event name\r\n                </th>\r\n                <th></th>\r\n                <th></th>\r\n            </tr>\r\n        </thead>\r\n        <tbody>\r\n            ',g=c.each.call(b,b,{hash:{},inverse:k.noop,fn:k.program(1,f,e),data:e}),(g||0===g)&&(h+=g),h+="\r\n        </tbody>\r\n    </table>\r\n</div>"}),this.CalendarTemplates["src/templates/panel"]=Handlebars.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i="function",j=this.escapeExpression;return h+='<div class="calendar-panel text-center">\r\n\r\n    <button class="btn btn-default panel-add-event" style="display:none">Add event</button>\r\n    <button class="btn btn-default panel-edit-event" style="display:none">Edit event</button>\r\n    <button class="btn btn-default panel-remove-event" style="display:none">Remove event</button>\r\n\r\n\r\n    <button class="btn btn-default save-events">Save events</button>\r\n    <button class="btn btn-default reload-events">Reload events</button>\r\n    <button class="btn btn-default clear-events">Clear events</button>\r\n\r\n    <br/>\r\n\r\n    <button class="btn btn-primary prev-year">Previous year</button>\r\n    <button class="btn btn-primary prev-month">Previous month</button>\r\n\r\n    <h2 style="display:inline-block">\r\n        <span class="label label-primary label-lg currentYearMonth">',(g=c.currentYearMonth)?f=g.call(b,{hash:{},data:e}):(g=b&&b.currentYearMonth,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'</span>\r\n    </h2>\r\n\r\n    <button class="btn btn-primary next-month">Next month</button>\r\n    <button class="btn btn-primary next-year">Next year</button>\r\n\r\n</div>\r\n\r\n<div class="calendar-loader"></div>'}),this.CalendarTemplates["src/templates/selectPartial"]=Handlebars.template(function(a,b,c,d,e){function f(a,b){var d,e,f="";return f+='\r\n        <option value="',(e=c.personId)?d=e.call(a,{hash:{},data:b}):(e=a&&a.personId,d=typeof e===i?e.call(a,{hash:{},data:b}):e),f+=j(d)+'">',(e=c.personName)?d=e.call(a,{hash:{},data:b}):(e=a&&a.personName,d=typeof e===i?e.call(a,{hash:{},data:b}):e),f+=j(d)+"</option>\r\n    "}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var g,h="",i="function",j=this.escapeExpression,k=this;return h+='<select class="person">\r\n    ',g=c.each.call(b,b&&b.people,{hash:{},inverse:k.noop,fn:k.program(1,f,e),data:e}),(g||0===g)&&(h+=g),h+="\r\n</select>"}),function(a){var b=function(b){var c={MODAL_TITLE:"Event modal",MODAL_BODY:"Please insert attendee and event names",PERSON_NAME:"Attendee's name",EVENT_NAME:"Event's name",ADD_EVENT_TITLE:"Add event",EDIT_EVENT_TITLE:"Edit event",CLOSE:"Close",ADD:"Add",EDIT:"Edit",PREVIOUS_YEAR:"Previous year",NEXT_YEAR:"Next year",PREVIOUS_MONTH:"Previous month",NEXT_MONTH:"Next month",AUTOSAVE:"Autosave",SAVE_EVENTS:"Save events",CLEAR_EVENTS:"Clear events",REMOVE:"Remove"},d=null,e=!1,f="localStorage",g=void 0,h=null,i=null,j=!0,k=void 0,l="top",m="",n=!0,o=[{personId:1,personName:"Test1"},{personId:2,personName:"Test2"},{personId:3,personName:"Test3"}],p=function(){return void 0!=localStorage?(this.saveAll=function(){if(u instanceof Object){for(var a=[],b=0;b<u.length;b++){var c=u[b],d={};jQuery.extend(d,c),d.container=void 0,a.push(d)}var e=JSON.stringify(a);localStorage.setItem("events",e)}else localStorage.removeItem("events")},this.readAll=function(){var a=localStorage.getItem("events");try{if(void 0==a||void 0==a)throw new Error("temp is undefined");for(var b=JSON.parse(a),c=0;c<b.length;c++){var d=b[c];F(d,!1)}}catch(e){u=new r}},this.clearAll=function(){u=new r,localStorage.removeItem("events")},this):void 0},q=function(){var a="ready";$(".calendar-loader").hide();var b=function(b){switch(a=b,b){case"load":$(".calendar-loader").fadeIn(250);break;case"idle":case"ready":$(".calendar-loader").fadeOut(500)}};return this.urls={getAllEvents:""},this.setUrls=function(a){this.urls=a},this.getUrls=function(){return this.urls},this.saveData=function(){var a={eventsToAdd:s,eventsToRemove:t},c=JSON.stringify(a);b("load"),$.ajax({type:"POST",url:this.urls.saveData,contentType:"application/json",data:c,success:function(){console.log("saved")},error:function(a){console.log(a)},complete:function(){b("idle")}})},this.saveAll=function(){this.saveData()},this.readAll=function(a,c){void 0==a&&(a=!1),b("load"),$.ajax({type:"GET",url:this.urls.getAllEvents,success:function(b){if(void 0!=b&&null!=b)for(var d=0;d<b.length;d++){var e=b[d];e.month-=1,F(e,!1)}a&&void 0!=c&&c(),M()},error:function(a){console.log(a)},complete:function(){b("idle")}})},this.clearAll=function(){console.log("cleared")},this},r=function(){return new Object},s=[],t=[],u=[],v=function(a,b,c){var d=b+1;return void 0!=c?a+"-"+d+"-"+c:void 0!=a&&void 0!=b?(10>d&&(d="0"+d),a+" - "+d):""},w=function(){k=CalendarTemplates,Handlebars.registerPartial("selectPartial",k.selectPartial),Handlebars.registerHelper("formatDate",v)},x=function(){w();var c=b,k="Calendar cannot be initialized. Dependency required: ";if(void 0==a.Handlebars)throw new Error(k+"Handlebars.js");if(void 0==a.jQuery)throw new Error(k+"jQuery.js");var m=!1;if("string"==typeof c)d=c;else{if("object"!=typeof c)throw new Error("Invalid options");if(d=c.selector,void 0!=c.debug&&(e=c.debug),void 0!=c.sync){var o={};if("string"==typeof c.sync?f=c.sync:"object"==typeof c.sync&&(void 0!=c.sync.type&&(f=c.sync.type),o.getAllEvents=c.sync.getAllEvents,o.saveData=c.sync.saveData),"localStorage"!=f&&"remote"!=f)throw new Error("Invalid sync type");switch(f){case"localStorage":g=new p;break;case"remote":g=new q,g.setUrls(o),m=!0;break;default:g=void 0}void 0!=g.readAll&&g.readAll(m)}void 0!=c.showEventList&&(1==c.showEventList||0==c.showEventList)&&(n=c.showEventList)}if(void 0==d||null==d)throw new Error("Invalid selector");if(e)for(var r=0;12>r;r++)for(var s=1;31>=s;s++)for(var t=0;1>t;t++)E(2014,r,s,"Jan Kowalski","Swimming",void 0,r*s*t);if(void 0==c.year||void 0==c.month&&"number"!=typeof c.year||"number"!=typeof c.month){var u=new Date;h=u.getFullYear(),i=u.getMonth()}else L(c.year,c.month);void 0==c.panel||"bottom"!=c.panel&&"top"!=c.panel||(l=c.panel),y(),z(),A(l),B(),C(),D(),void 0!=c.render&&(j=c.render),j&&M()},y=function(){$(d).append('<div class="calendar-container"></div>'),m=d+" .calendar-container"},z=function(){var a={add:!0,RESOURCES:c,enable_dropdown:!0,people:o},b=k.eventModal(a);$("body").append(b)},A=function(a){var b=h+" - "+(i+1),c={currentYearMonth:b},d=k.panel(c);"bottom"==a?$(m).after(d):$(m).before(d)},B=function(){var a=".calendar-panel ";$(a+".prev-month").click(function(){i--,0>i&&(i=11,h--),M()}),$(a+".next-month").click(function(){i++,i>11&&(i=0,h++),M()});var b=function(a){h+=a,M()};$(a+".prev-year").click(function(){b(-1)}),$(a+".next-year").click(function(){b(1)});var c=function(a){var b=$("#calendarEventModal"),c=b.find(".person"),d=b.find(".eventName"),e=c.val(),f=d.val();E(h,i,a,e,f),M(),c.val(""),d.val("")};$(d).on("click",".panel-add-event",function(){var a=$("#calendarEventModal"),b=$(d).find(".week-day-div.selected");if(b.length>0){var c=$(b).parent().data("day"),e=h+"-"+i+"-"+c,f=a.find(".modalTitleDate");f.html(e);var g=a.find(".eventDay");g.val(c),a.modal("show")}}),$(d).on("click",".panel-edit-event",function(){var a=$("#calendarEventModal"),b=$(d).find(".event.selected");if(b.length>0){var c=$(b).data("day"),e=$(b).data("eventid"),f=h+"-"+i+"-"+c;a.find(".modalTitleDate").html(f),a.find(".eventDay").val(c),a.find(".eventId").val(e),a.modal("show")}}),$(d).on("click",".panel-remove-event",function(){var a=$(d).find(".event.selected");if(a.length>0){var b=($(a).data("day"),$(a).data("eventid"));void 0!=b&&(G(b),M())}}),$(d).on("click",".week-day-div",function(){var a=$(this).hasClass("selected"),b=$(d+" .btn.panel-add-event");a?($(this).removeClass("selected"),b.hide()):($(d+" .week-day-div").removeClass("selected"),$(this).addClass("selected"),b.show())}),$(d).on("click",".event",function(a){a.stopPropagation();var b=$(this).hasClass("selected"),c=$(d+" .btn.panel-edit-event"),e=$(d+" .btn.panel-remove-event");b?($(this).removeClass("selected"),c.hide(),e.hide()):($(d+" .event").removeClass("selected"),$(this).addClass("selected"),c.show(),e.show())}),$("#calendarEventModal .add-event").click(function(){var a=$("#calendarEventModal .eventDay").val();c(a);var b=$("#calendarEventModal");b.modal("hide")}),$(a+".save-events").click(function(){S()}),$(a+".clear-events").click(function(){T(),M()}),$(a+".reload-events").click(function(){T(),g.readAll(!0,function(){M()})})},C=function(){$(d).append('<div class="event-container"></div>')},D=function(){$(".event-container").on("click",".edit-event2",function(){var a=$(this).data("eventid");if(void 0!=a){var b=$("#calendarEventModal");b.find(".eventId").val(a),b.modal("show")}return!1}),$(".event-container").on("click",".remove-event2",function(){var a=$(this).data("eventid");return void 0!=a&&(G(a),M()),!1})},E=function(a,b,c,d,e,f,g){void 0==f&&(f=Q()),void 0==g&&(g=(new Date).getTime());var h={eventId:g,personName:d,eventName:e,color:f,unsaved:!0,year:a,month:b,day:c};F(h,!0)},F=function(a,b){void 0==b&&(b=!1),"object"==typeof a&&(b&&(a.unsaved=!0,s.push(a)),u.push(a))},G=function(a){for(var b=null,c=0;c<u.length;c++)if(u[c].eventId==a){b=u[c];break}if(null!=b){var d=u.indexOf(b);-1!=d&&(t.push(b),u.splice(d,1))}},H=function(){return["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"]},I=function(a,b,c){for(var d=[],e=0;e<u.length;e++){var f=u[e];f.year==a&&f.month==b&&f.day==c&&d.push(f)}return d},J=function(a,b){for(var c=[],d=0;d<u.length;d++){var e=u[d];e.year==a&&e.month==b&&c.push(e)}return c},K=function(a,b){var c=new Date,d=c.getFullYear(),e=c.getMonth(),f=c.getDate(),g=new Date(a,b),h=(g.getMonth(),[]),i={days:[]},j=0,k=function(a){j++,i.days.push(a)},l=function(){h.push(i),i={days:[]}},m=new Date(g);m.setDate(m.getDate()-1);for(var n=m.getDay(),o=0;n>o;o++)k({});var p=g.getDate();do{j%7==0&&l(i);var q={date_string:R(a,b,p),bg_color:"#DEDEDE",dayValue:p};a==d&&b==e&&p==f&&(q.current=!0);var r=I(a,b,p);q.events=r,k(q),p++,g=new Date(a,b,p),p=g.getDate()}while(p>1);return i.days.length>0&&l(i),h},L=function(a,b){h=a,i=b},M=function(a,b,c){void 0!=a&&void 0!=b&&L(a,b),void 0==c&&(c=["calendar","events"]),N(),O();var d=v(h,i);$(".calendar-panel .currentYearMonth").html(d),-1!=c.indexOf("calendar"),c.indexOf("events")-1},N=function(){var a=$(m),b=h;b+=9>i?" 0"+(i+1):" "+(i+1);var c=K(h,i),d={weekdays:H(),weeks:c},e=k.calendar(d);a.html(e)},O=function(){if(n){var a=J(h,i),b=k.events(a);$(d+" .event-container").html(a.length>0?b:"")}},P=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"],Q=function(){for(var a="#",b=0;6>b;b++){var c=Math.floor(Math.random()*P.length);a+=P[c]}return a},R=function(a,b,c){return b+=1,10>b&&(b="0"+b),10>c&&(c="0"+c),a+"-"+b+"-"+c},S=function(){void 0!=g&&g.saveAll()},T=function(){u=new r,s=new r,t=new r};return x(),{render:M,addEvent:E,removeEvent:G,getEvents:function(){return u},saveEvents:S,clearEvents:T}};a.Calendar=b}(window);